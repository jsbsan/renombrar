' Gambas class file

Public Sub ButtonCargarFicheros_Click()

  Dim arrayficheros As String[]
  Dim TerminarFicheros As New String[]
  Dim ficherotmp As String

  arrayficheros = Dir(TextBoxDir.text, "*", gb.file)

  For Each ficherotmp In arrayficheros
    TerminarFicheros.Add(TextBoxDir.text & "/" & ficherotmp)
  Next

  TextAreaListaFicheros.Text = TerminarFicheros.Join("\n")

End

Public Sub ButtonEjecutarAdelante_Click()

  Dim arrayficheros As String[]
  Dim nombrefichero As String
  Dim nuevocontenido As String

  arrayficheros = OBTENERFICHEROS()

  For Each nombrefichero In arrayficheros
    If nombrefichero = "" Then Continue
    Move nombrefichero To File.Dir(nombrefichero) & "/" & TextBoxPalabraDelante.text & " " & File.BaseName(nombrefichero) & "." & File.Ext(nombrefichero)
    nuevocontenido &= File.Dir(nombrefichero) & "/" & TextBoxPalabraDelante.text & " " & File.BaseName(nombrefichero) & "." & File.Ext(nombrefichero) & gb.CrLf

  Next

  TextAreaListaFicheros.Text = nuevocontenido

End

Public Sub ButtonEjecutarAtras_Click()

  Dim arrayficheros As String[]
  Dim nombrefichero As String
  Dim nuevocontenido As String

  arrayficheros = OBTENERFICHEROS()

  For Each nombrefichero In arrayficheros
    If nombrefichero = "" Then Continue
    Move nombrefichero To File.Dir(nombrefichero) & "/" & File.BaseName(nombrefichero) & " " & TextBoxPalabraAtras.text & "." & File.Ext(nombrefichero)
    nuevocontenido &= File.Dir(nombrefichero) & "/" & File.BaseName(nombrefichero) & " " & TextBoxPalabraAtras.text & "." & File.Ext(nombrefichero) & gb.CrLf
  Next

  TextAreaListaFicheros.Text = nuevocontenido

End

Public Sub ButtonEjecutarEliminarPalabra_Click()

  Dim arrayficheros As String[]
  Dim nombrefichero As String
  Dim nuevocontenido As String

  arrayficheros = OBTENERFICHEROS()

  For Each nombrefichero In arrayficheros
    If nombrefichero = "" Then Continue
    Try Move nombrefichero To File.Dir(nombrefichero) & "/" & Replace(File.name(nombrefichero), TextBoxEliminar.text, "")
    nuevocontenido &= File.Dir(nombrefichero) & "/" & Replace(File.name(nombrefichero), TextBoxEliminar.text, "") & gb.CrLf
  Next

  TextAreaListaFicheros.Text = nuevocontenido

End

Public Sub Form_Open()

  LabelVersion.Text = Application.Name & "\n" & "Version " & Application.Version

End

Public Sub Form_Show()

  Settings.Read(Me)

End

Public Function OBTENERFICHEROS() As String[]

  Return Split(TextAreaListaFicheros.TEXT, "\n")

End

Public Sub TextAreaListaFicheros_Leave()

  TextAreaListaFicheros.Text = Replace(TextAreaListaFicheros.text, "file://", "")
  TextAreaListaFicheros.Text = Replace(TextAreaListaFicheros.text, "%20", " ")

End

Public Sub ButtonEjecutarReemplazar_Click()

  Dim arrayficheros As String[]
  Dim nombrefichero As String
  Dim nuevocontenido As String

  arrayficheros = OBTENERFICHEROS()

  For Each nombrefichero In arrayficheros
    If nombrefichero = "" Then Continue
    Try Move nombrefichero To File.Dir(nombrefichero) & "/" & Replace(File.name(nombrefichero), TextBoxReemplaza.text, TextBoxPor.text)
    nuevocontenido &= File.Dir(nombrefichero) & "/" & Replace(File.name(nombrefichero), TextBoxReemplaza.text, TextBoxPor.text) & gb.CrLf
  Next
  TextAreaListaFicheros.Text = nuevocontenido

End

Public Sub ButtonDir_Click()

  If Dialog.SelectDirectory() Then
    Return
  Else
    TextBoxDir.Text = Dialog.Path
  Endif

End

Public Sub ButtonSalir_Click()

  Me.Close()

End

Public Sub Form_Close()

  Settings.Write(Me)

End
